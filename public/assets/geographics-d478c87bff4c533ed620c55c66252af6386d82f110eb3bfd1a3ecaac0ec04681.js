bhlApp.factory("GoogleMap",["$http",function(e){var o=function(o){function n(o){var n=new google.maps.Marker({map:t,position:new google.maps.LatLng(o.latitude,o.longitude),icon:o.icon,category:o.category});google.maps.event.addListener(n,"click",function(){e.get("/geographics/show/"+o.address).success(function(e){a.setContent(e),a.open(t,n)})}),c.push(n)}var t,a,c;this.initialize=function(e){var o={zoom:2,center:{lat:30.064742,lng:31.249509},mapTypeId:google.maps.MapTypeId.TERRAIN};t=new google.maps.Map(e,o),a=new google.maps.InfoWindow,c=[]},this.removeSelectedPins=function(e){angular.forEach(c,function(o){o.category==e&&o.setMap(null)})},this.fillMapWithMarkers=function(o){var t;t=o?"/geographics/load_books/"+o:"/geographics/load_books",e.get(t).success(function(e){angular.forEach(e,function(e){n(e)})})},this.initialize(o)};return o}]),bhlApp.controller("MapCtrl",["$scope","GoogleMap",function(e,o){var n;e.updatePins=function(o){var t="check_"+o;e[t]?n.fillMapWithMarkers(o):n.removeSelectedPins(o)},e.setSelectPins=function(){e.check_100=!0,e.check_200=!0,e.check_300=!0,e.check_400=!0,e.check_500=!0,n=new o(document.getElementById("map")),n.fillMapWithMarkers()}}]);