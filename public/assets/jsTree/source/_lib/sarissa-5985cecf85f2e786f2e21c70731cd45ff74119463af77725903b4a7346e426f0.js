/* * ====================================================================
 * About: This a a compressed JS file from the Sarissa library. 
 * see http://dev.abiss.gr/sarissa
 * 
 * Copyright: Manos Batsis, http://dev.abiss.gr
 * 
 * Licence:
 * Sarissa is free software distributed under the GNU GPL version 2 
 * or higher, GNU LGPL version 2.1 or higher and Apache Software 
 * License 2.0 or higher. The licenses are available online see: 
 * http://www.gnu.org  
 * http://www.apache.org
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY 
 * KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE 
 * WARRANTIES OF MERCHANTABILITY,FITNESS FOR A PARTICULAR PURPOSE 
 * AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR 
 * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR 
 * OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE 
 * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================*/
function Sarissa(){}if(Sarissa.VERSION="0.9.9.4",Sarissa.PARSED_OK="Document contains no parsing errors",Sarissa.PARSED_EMPTY="Document is empty",Sarissa.PARSED_UNKNOWN_ERROR="Not well-formed or other error",Sarissa.IS_ENABLED_TRANSFORM_NODE=!1,Sarissa.REMOTE_CALL_FLAG="gr.abiss.sarissa.REMOTE_CALL_FLAG",Sarissa._lastUniqueSuffix=0,Sarissa._getUniqueSuffix=function(){return Sarissa._lastUniqueSuffix++},Sarissa._SARISSA_IEPREFIX4XSLPARAM="",Sarissa._SARISSA_HAS_DOM_IMPLEMENTATION=document.implementation&&!0,Sarissa._SARISSA_HAS_DOM_CREATE_DOCUMENT=Sarissa._SARISSA_HAS_DOM_IMPLEMENTATION&&document.implementation.createDocument,Sarissa._SARISSA_HAS_DOM_FEATURE=Sarissa._SARISSA_HAS_DOM_IMPLEMENTATION&&document.implementation.hasFeature,Sarissa._SARISSA_IS_MOZ=Sarissa._SARISSA_HAS_DOM_CREATE_DOCUMENT&&Sarissa._SARISSA_HAS_DOM_FEATURE,Sarissa._SARISSA_IS_SAFARI=-1!=navigator.userAgent.toLowerCase().indexOf("safari")||-1!=navigator.userAgent.toLowerCase().indexOf("konqueror"),Sarissa._SARISSA_IS_SAFARI_OLD=Sarissa._SARISSA_IS_SAFARI&&parseInt((navigator.userAgent.match(/AppleWebKit\/(\d+)/)||{})[1],10)<420,Sarissa._SARISSA_IS_IE=document.all&&window.ActiveXObject&&navigator.userAgent.toLowerCase().indexOf("msie")>-1&&-1==navigator.userAgent.toLowerCase().indexOf("opera"),Sarissa._SARISSA_IS_OPERA=-1!=navigator.userAgent.toLowerCase().indexOf("opera"),window.Node&&Node.ELEMENT_NODE||(Node={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12}),Sarissa._SARISSA_IS_SAFARI_OLD){HTMLHtmlElement=document.createElement("html").constructor,Node=HTMLElement={},HTMLElement.prototype=HTMLHtmlElement.__proto__.__proto__,HTMLDocument=Document=document.constructor;var x=new DOMParser;XMLDocument=x.constructor,Element=x.parseFromString("<Single />","text/xml").documentElement.constructor,x=null}if("undefined"==typeof XMLDocument&&"undefined"!=typeof Document&&(XMLDocument=Document),Sarissa._SARISSA_IS_IE){Sarissa._SARISSA_IEPREFIX4XSLPARAM="xsl:";var _SARISSA_DOM_PROGID="",_SARISSA_XMLHTTP_PROGID="",_SARISSA_DOM_XMLWRITER="";Sarissa.pickRecentProgID=function(e){for(var t,r,a=!1,o=0;o<e.length&&!a;o++)try{new ActiveXObject(e[o]);r=e[o],a=!0}catch(s){t=s}if(!a)throw"Could not retrieve a valid progID of Class: "+e[e.length-1]+". (original exception: "+t+")";return e=null,r},_SARISSA_DOM_PROGID=null,_SARISSA_THREADEDDOM_PROGID=null,_SARISSA_XSLTEMPLATE_PROGID=null,_SARISSA_XMLHTTP_PROGID=null,XMLHttpRequest=function(){return _SARISSA_XMLHTTP_PROGID||(_SARISSA_XMLHTTP_PROGID=Sarissa.pickRecentProgID(["Msxml2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"])),new ActiveXObject(_SARISSA_XMLHTTP_PROGID)},Sarissa.getDomDocument=function(e,t){_SARISSA_DOM_PROGID||(_SARISSA_DOM_PROGID=Sarissa.pickRecentProgID(["Msxml2.DOMDocument.6.0","Msxml2.DOMDocument.3.0","MSXML2.DOMDocument","MSXML.DOMDocument","Microsoft.XMLDOM"]));var r=new ActiveXObject(_SARISSA_DOM_PROGID);if(t){var a="";e&&(t.indexOf(":")>1?(a=t.substring(0,t.indexOf(":")),t=t.substring(t.indexOf(":")+1)):a="a"+Sarissa._getUniqueSuffix()),e?r.loadXML("<"+a+":"+t+" xmlns:"+a+'="'+e+'" />'):r.loadXML("<"+t+" />")}return r},Sarissa.getParseErrorText=function(e){var t=Sarissa.PARSED_OK;if(e&&e.parseError&&e.parseError.errorCode&&0!=e.parseError.errorCode){t="XML Parsing Error: "+e.parseError.reason+"\nLocation: "+e.parseError.url+"\nLine Number "+e.parseError.line+", Column "+e.parseError.linepos+":\n"+e.parseError.srcText+"\n";for(var r=0;r<e.parseError.linepos;r++)t+="-";t+="^\n"}else null===e.documentElement&&(t=Sarissa.PARSED_EMPTY);return t},Sarissa.setXpathNamespaces=function(e,t){e.setProperty("SelectionLanguage","XPath"),e.setProperty("SelectionNamespaces",t)},XSLTProcessor=function(){_SARISSA_XSLTEMPLATE_PROGID||(_SARISSA_XSLTEMPLATE_PROGID=Sarissa.pickRecentProgID(["Msxml2.XSLTemplate.6.0","MSXML2.XSLTemplate.3.0"])),this.template=new ActiveXObject(_SARISSA_XSLTEMPLATE_PROGID),this.processor=null},XSLTProcessor.prototype.importStylesheet=function(e){_SARISSA_THREADEDDOM_PROGID||(_SARISSA_THREADEDDOM_PROGID=Sarissa.pickRecentProgID(["MSXML2.FreeThreadedDOMDocument.6.0","MSXML2.FreeThreadedDOMDocument.3.0"])),e.setProperty("SelectionLanguage","XPath"),e.setProperty("SelectionNamespaces","xmlns:xsl='http://www.w3.org/1999/XSL/Transform'");var t=new ActiveXObject(_SARISSA_THREADEDDOM_PROGID);try{t.resolveExternals=!0,t.setProperty("AllowDocumentFunction",!0)}catch(r){}e.url&&null!=e.selectSingleNode("//xsl:*[local-name() = 'import' or local-name() = 'include']")?(t.async=!1,t.load(e.url)):t.loadXML(e.xml),t.setProperty("SelectionNamespaces","xmlns:xsl='http://www.w3.org/1999/XSL/Transform'");var a=t.selectSingleNode("//xsl:output");a?this.outputMethod=a.getAttribute("method"):delete this.outputMethod,this.template.stylesheet=t,this.processor=this.template.createProcessor(),this.paramsSet=[]},XSLTProcessor.prototype.transformToDocument=function(e){var t;if(_SARISSA_THREADEDDOM_PROGID)return this.processor.input=e,t=new ActiveXObject(_SARISSA_DOM_PROGID),this.processor.output=t,this.processor.transform(),t;_SARISSA_DOM_XMLWRITER||(_SARISSA_DOM_XMLWRITER=Sarissa.pickRecentProgID(["Msxml2.MXXMLWriter.6.0","Msxml2.MXXMLWriter.3.0","MSXML2.MXXMLWriter","MSXML.MXXMLWriter","Microsoft.XMLDOM"])),this.processor.input=e,t=new ActiveXObject(_SARISSA_DOM_XMLWRITER),this.processor.output=t,this.processor.transform();var r=new ActiveXObject(_SARISSA_DOM_PROGID);return r.loadXML(t.output+""),r},XSLTProcessor.prototype.transformToFragment=function(e,t){this.processor.input=e,this.processor.transform();var r,a=this.processor.output,o=t.createDocumentFragment();if("text"==this.outputMethod)o.appendChild(t.createTextNode(a));else if(t.body&&t.body.innerHTML)for(r=t.createElement("div"),r.innerHTML=a;r.hasChildNodes();)o.appendChild(r.firstChild);else{var s=new ActiveXObject(_SARISSA_DOM_PROGID);"<?xml"==a.substring(0,5)&&(a=a.substring(a.indexOf("?>")+2));var n="".concat("<my>",a,"</my>");for(s.loadXML(n),r=s.documentElement;r.hasChildNodes();)o.appendChild(r.firstChild)}return o},XSLTProcessor.prototype.setParameter=function(e,t,r){r=r?r:"",e?this.processor.addParameter(t,r,e):this.processor.addParameter(t,r),e=""+(e||""),this.paramsSet[e]||(this.paramsSet[e]=[]),this.paramsSet[e][t]=r},XSLTProcessor.prototype.getParameter=function(e,t){return e=""+(e||""),this.paramsSet[e]&&this.paramsSet[e][t]?this.paramsSet[e][t]:null},XSLTProcessor.prototype.clearParameters=function(){for(var e in this.paramsSet)for(var t in this.paramsSet[e])""!=e?this.processor.addParameter(t,"",e):this.processor.addParameter(t,"");this.paramsSet=[]}}else Sarissa._SARISSA_HAS_DOM_CREATE_DOCUMENT&&(Sarissa.__handleLoad__=function(e){Sarissa.__setReadyState__(e,4)},_sarissa_XMLDocument_onload=function(){Sarissa.__handleLoad__(this)},Sarissa.__setReadyState__=function(e,t){e.readyState=t,e.readystate=t,null!=e.onreadystatechange&&"function"==typeof e.onreadystatechange&&e.onreadystatechange()},Sarissa.getDomDocument=function(e,t){var r=document.implementation.createDocument(e?e:null,t?t:null,null);return r.onreadystatechange||(r.onreadystatechange=null),r.readyState||(r.readyState=0),r.addEventListener("load",_sarissa_XMLDocument_onload,!1),r},window.XMLDocument||(Sarissa._SARISSA_HAS_DOM_FEATURE&&window.Document&&!Document.prototype.load&&document.implementation.hasFeature("LS","3.0")?Sarissa.getDomDocument=function(e,t){var r=document.implementation.createDocument(e?e:null,t?t:null,null);return r}:Sarissa.getDomDocument=function(e,t){var r=document.implementation.createDocument(e?e:null,t?t:null,null);return r&&(e||t)&&!r.documentElement&&r.appendChild(r.createElementNS(e,t)),r}));if(window.DOMParser||(Sarissa._SARISSA_IS_SAFARI?(DOMParser=function(){},DOMParser.prototype.parseFromString=function(e,t){var r=new XMLHttpRequest;return r.open("GET","data:text/xml;charset=utf-8,"+encodeURIComponent(e),!1),r.send(null),r.responseXML}):Sarissa.getDomDocument&&Sarissa.getDomDocument()&&Sarissa.getDomDocument(null,"bar").xml&&(DOMParser=function(){},DOMParser.prototype.parseFromString=function(e,t){var r=Sarissa.getDomDocument();return r.loadXML(e),r})),"undefined"==typeof document.importNode&&Sarissa._SARISSA_IS_IE)try{document.importNode=function(e,t){var r;return"#text"==e.nodeName?document.createTextNode(e.data):(r="tbody"==e.nodeName||"tr"==e.nodeName?document.createElement("table"):"td"==e.nodeName?document.createElement("tr"):"option"==e.nodeName?document.createElement("select"):document.createElement("div"),t?r.innerHTML=e.xml?e.xml:e.outerHTML:r.innerHTML=e.xml?e.cloneNode(!1).xml:e.cloneNode(!1).outerHTML,r.getElementsByTagName("*")[0])}}catch(e){}Sarissa.getParseErrorText||(Sarissa.getParseErrorText=function(e){var t=Sarissa.PARSED_OK;if(e&&e.documentElement)if("parsererror"==e.documentElement.tagName)t=e.documentElement.firstChild.data,t+="\n"+e.documentElement.firstChild.nextSibling.firstChild.data;else if(e.getElementsByTagName("parsererror").length>0){var r=e.getElementsByTagName("parsererror")[0];t=Sarissa.getText(r,!0)+"\n"}else e.parseError&&0!=e.parseError.errorCode&&(t=Sarissa.PARSED_UNKNOWN_ERROR);else t=Sarissa.PARSED_EMPTY;return t}),Sarissa.getText=function(e,t){for(var r="",a=e.childNodes,o=0;o<a.length;o++){var s=a[o],n=s.nodeType;n==Node.TEXT_NODE||n==Node.CDATA_SECTION_NODE?r+=s.data:t!==!0||n!=Node.ELEMENT_NODE&&n!=Node.DOCUMENT_NODE&&n!=Node.DOCUMENT_FRAGMENT_NODE||(r+=Sarissa.getText(s,!0))}return r},!window.XMLSerializer&&Sarissa.getDomDocument&&Sarissa.getDomDocument("","foo",null).xml&&(XMLSerializer=function(){},XMLSerializer.prototype.serializeToString=function(e){return e.xml}),Sarissa.stripTags=function(e){return e?e.replace(/<[^>]+>/g,""):e},Sarissa.clearChildNodes=function(e){for(;e.firstChild;)e.removeChild(e.firstChild)},Sarissa.copyChildNodes=function(e,t,r){if(Sarissa._SARISSA_IS_SAFARI&&t.nodeType==Node.DOCUMENT_NODE&&(t=t.documentElement),!e||!t)throw"Both source and destination nodes must be provided";r||Sarissa.clearChildNodes(t);var a,o=t.nodeType==Node.DOCUMENT_NODE?t:t.ownerDocument,s=e.childNodes;if("undefined"!=typeof o.importNode)for(a=0;a<s.length;a++)t.appendChild(o.importNode(s[a],!0));else for(a=0;a<s.length;a++)t.appendChild(s[a].cloneNode(!0))},Sarissa.moveChildNodes=function(e,t,r){if(!e||!t)throw"Both source and destination nodes must be provided";r||Sarissa.clearChildNodes(t);var a=e.childNodes;if(e.ownerDocument==t.ownerDocument)for(;e.firstChild;)t.appendChild(e.firstChild);else{var o,s=t.nodeType==Node.DOCUMENT_NODE?t:t.ownerDocument;if("undefined"!=typeof s.importNode)for(o=0;o<a.length;o++)t.appendChild(s.importNode(a[o],!0));else for(o=0;o<a.length;o++)t.appendChild(a[o].cloneNode(!0));Sarissa.clearChildNodes(e)}},Sarissa.xmlize=function(e,t,r){r=r?r:"";var a=r+"<"+t+">",o=!1;if(!(e instanceof Object)||e instanceof Number||e instanceof String||e instanceof Boolean||e instanceof Date)a+=Sarissa.escape(""+e),o=!0;else{a+="\n";var s=e instanceof Array;for(var n in e)a+=Sarissa.xmlize(e[n],s?'array-item key="'+n+'"':n,r+"   ");a+=r}return a+=-1!=t.indexOf(" ")?"</array-item>\n":"</"+t+">\n"},Sarissa.escape=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")},Sarissa.unescape=function(e){return e.replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&")},Sarissa.updateCursor=function(e,t){e&&e.style&&void 0!=e.style.cursor&&(e.style.cursor=t)},Sarissa.updateContentFromURI=function(e,t,r,a,o){try{Sarissa.updateCursor(t,"wait");var s=new XMLHttpRequest;if(s.open("GET",e,!0),s.onreadystatechange=function(){if(4==s.readyState)try{var o=s.responseXML;if(!o||Sarissa.getParseErrorText(o)!=Sarissa.PARSED_OK)throw Sarissa.getParseErrorText(o);Sarissa.updateContentFromNode(s.responseXML,t,r),a&&a(e,t)}catch(n){if(!a)throw n;a(e,t,n)}},o){var n="Sat, 1 Jan 2000 00:00:00 GMT";s.setRequestHeader("If-Modified-Since",n)}s.send("")}catch(i){if(Sarissa.updateCursor(t,"auto"),!a)throw i;a(e,t,i)}},Sarissa.updateContentFromNode=function(e,t,r){try{Sarissa.updateCursor(t,"wait"),Sarissa.clearChildNodes(t);var a=e.nodeType==Node.DOCUMENT_NODE?e:e.ownerDocument;if(a.parseError&&0!=a.parseError.errorCode){var o=document.createElement("pre");o.appendChild(document.createTextNode(Sarissa.getParseErrorText(a))),t.appendChild(o)}else if(r&&(e=r.transformToDocument(e)),"textarea"==t.tagName.toLowerCase()||"input"==t.tagName.toLowerCase())t.value=(new XMLSerializer).serializeToString(e);else try{t.appendChild(t.ownerDocument.importNode(e,!0))}catch(s){t.innerHTML=(new XMLSerializer).serializeToString(e)}}catch(s){throw s}finally{Sarissa.updateCursor(t,"auto")}},Sarissa.formToQueryString=function(e){for(var t="",r=0;r<e.elements.length;r++){var a=e.elements[r],o=a.getAttribute("name")?a.getAttribute("name"):a.getAttribute("id");if(o&&(!a.disabled||"hidden"==a.type))switch(a.type){case"hidden":case"text":case"textarea":case"password":t+=o+"="+encodeURIComponent(a.value)+"&";break;case"select-one":t+=o+"="+encodeURIComponent(a.options[a.selectedIndex].value)+"&";break;case"select-multiple":for(var s=0;s<a.length;s++){var n=a.options[s];n.selected===!0&&(t+=o+"[]="+encodeURIComponent(n.value)+"&")}break;case"checkbox":case"radio":a.checked&&(t+=o+"="+encodeURIComponent(a.value)+"&")}}return t.substr(0,t.length-1)},Sarissa.updateContentFromForm=function(e,t,r,a){try{Sarissa.updateCursor(t,"wait");var o=Sarissa.formToQueryString(e)+"&"+Sarissa.REMOTE_CALL_FLAG+"=true",s=new XMLHttpRequest,n=e.getAttribute("method")&&"get"==e.getAttribute("method").toLowerCase();n?s.open("GET",e.getAttribute("action")+"?"+o,!0):(s.open("POST",e.getAttribute("action"),!0),s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),s.setRequestHeader("Content-length",o.length),s.setRequestHeader("Connection","close")),s.onreadystatechange=function(){try{if(4==s.readyState){var o=s.responseXML;if(!o||Sarissa.getParseErrorText(o)!=Sarissa.PARSED_OK)throw Sarissa.getParseErrorText(o);Sarissa.updateContentFromNode(s.responseXML,t,r),a&&a(e,t)}}catch(n){if(!a)throw n;a(e,t,n)}},s.send(n?"":o)}catch(i){if(Sarissa.updateCursor(t,"auto"),!a)throw i;a(e,t,i)}return!1},Sarissa.FUNCTION_NAME_REGEXP=new RegExp(""),Sarissa.getFunctionName=function(e,t){var r;return r||(t?(r="SarissaAnonymous"+Sarissa._getUniqueSuffix(),window[r]=e):r=null),r&&(window[r]=e),r},Sarissa.setRemoteJsonCallback=function(e,t,r){r||(r="callback");var a=Sarissa.getFunctionName(t,!0),o="sarissa_json_script_id_"+Sarissa._getUniqueSuffix(),s=document.getElementsByTagName("head")[0],n=document.createElement("script");return n.type="text/javascript",n.id=o,n.onload=function(){},e+=-1!=e.indexOf("?")?"&"+r+"="+a:"?"+r+"="+a,n.src=e,s.appendChild(n),o};