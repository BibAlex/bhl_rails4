/**
 * jQuery.Listen - Light and fast event handling, using event delegation.
 * Copyright (c) 2007-2008 Ariel Flesler - aflesler(at)gmail(dot)com | http://flesler.blogspot.com
 * Dual licensed under MIT and GPL.
 * Date: 3/7/2008
 * http://flesler.blogspot.com/2007/10/jquerylisten.html
 * @version 1.0.3
 */
!function(n){function t(e,i){n.extend(this,{ids:{},tags:{},listener:i,event:e}),this.id=t.instances.push(this)}function e(n,t,e){for(var i=0,s=n.length;s>i;i++)t.call(e,n[i],i)}function i(n,t){return n.push.apply(n,t),n}var s="indexer",a=n.event,o=a.special,r=n.listen=function(n,i,s,a){"object"!=typeof i&&(a=s,s=i,i=document),e(n.split(/\s+/),function(n){n=r.fixes[n]||n;var e=u(i,n)||u(i,n,new t(n,i));e.append(s,a),e.start()})},u=function(t,e,i){return n.data(t,e+"."+s,i)};n.fn[s]=function(n){return this[0]&&u(this[0],n)||null},n[s]=function(n){return u(document,n)},n.extend(r,{regex:/^((?:\w*?|\*))(?:([#.])([\w-]+))?$/,fixes:{focus:"focusin",blur:"focusout"},cache:function(n){this.caching=n}}),n.each(r.fixes,function(t,e){o[e]={setup:function(){return n.browser.msie?!1:void this.addEventListener(t,o[e].handler,!0)},teardown:function(){return n.browser.msie?!1:void this.removeEventListener(t,o[e].handler,!0)},handler:function(n){return arguments[0]=n=a.fix(n),n.type=e,a.handle.apply(this,arguments)}}}),n.fn.listen=function(n,t,e){return this.each(function(){r(n,this,t,e)})},t.instances=[],t.prototype={constructor:t,handle:function(n){var t=n.stopPropagation;n.stopPropagation=function(){n.stopped=1,t.apply(this,arguments)},u(this,n.type).parse(n),n.stopPropagation=t,t=n.data=null},on:0,bubbles:0,start:function(){var n=this;n.on||(a.add(n.listener,n.event,n.handle),n.on=1)},stop:function(){var n=this;n.on&&(a.remove(n.listener,n.event,n.handle),n.on=0)},cache:function(t,e){return n.data(t,"listenCache_"+this.id,e)},parse:function(n){var t,s=this,a=n.data||n.target,o=arguments;r.caching&&(t=s.cache(a))||(t=[],a.id&&s.ids[a.id]&&i(t,s.ids[a.id]),e([a.nodeName,"*"],function(n){var o=s.tags[n];o&&e((a.className+" *").split(" "),function(n){n&&o[n]&&i(t,o[n])})}),r.caching&&s.cache(a,t)),t[0]&&e(t,function(t){t.apply(a,o)===!1&&(n.preventDefault(),n.stopPropagation())}),!n.stopped&&(a=a.parentNode)&&("A"==a.nodeName||s.bubbles&&a!=s.listener)&&(n.data=a,s.parse(n)),t=o=a=null},append:function(n,t){var i=this;e(n.split(/\s*,\s*/),function(n){var e=r.regex.exec(n);if(!e)throw'$.listen > "'+n+'" is not a supported selector.';var s="#"==e[2]&&e[3],a=e[1].toUpperCase()||"*",o=e[3]||"*";s?(i.ids[s]||(i.ids[s]=[])).push(t):a&&(a=i.tags[a]=i.tags[a]||{},(a[o]||(a[o]=[])).push(t))})}},n(window).unload(function(){"function"==typeof t&&e(t.instances,function(t){t.stop(),n.removeData(t.listener,t.event+"."+s),t.ids=t.names=t.listener=null})})}(jQuery);