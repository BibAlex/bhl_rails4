function confirmDelete_photo(id){
    var r= confirm("<%= I18n.t('collection.delete_collection_photo_confirm') %>");
    if (r)
      get_or_delete_photo(id, 1);
    else{
      $('#delete_photo').removeAttr('checked');
      return false;
      }
  }
  
function confirmBookDeleteFromCollection(){
    var r= confirm("<%= I18n.t('collection.remove_book_from_collection_confirm') %>");
    return r;
}
  
function get_or_delete_photo(id, is_delete){
    var xmlhttp;
    if (window.XMLHttpRequest)
    {
      // code for IE7+, Firefox, Chrome, Opera, Safari
      xmlhttp=new XMLHttpRequest();
    }
    else
    {
      // code for IE6, IE5
      xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange=function(){
      if (xmlhttp.readyState==4 && xmlhttp.status==200)
      {
        if (is_delete == 1)
          alert("<%= I18n.t('collection.delete_photo_flash') %>");
        document.getElementById("photo").innerHTML=xmlhttp.responseText;
      }
    }  
    xmlhttp.open("GET","/get_or_delete_collection_photo?id="+ id +"&is_delete="+ is_delete,true);
    xmlhttp.send();
  }

function check_image_size() {
  var is_file_valid = true;
  if ($('#filefield')[0].files[0] != null){
    var ext = $('#filefield').val().split('.').pop().toLowerCase();
    var size = $('#filefield')[0].files[0].size;
    if($.inArray(ext, ['gif','png','jpg','jpeg', 'bmp']) == -1) {
      $('#photo_ext_error_message').removeClass("invisible_error_msg");
      $('#photo_ext_error_message').addClass("visible_error_msg");
      $('#photo_size_error_message').removeClass("visible_error_msg");
      $('#photo_size_error_message').addClass("invisible_error_msg");
      is_file_valid = false;
    }
    else{
      if (size > #{UPLOADED_PHOTO_MAX_SIZE * 1000 * 1000}){
        $('#photo_ext_error_message').removeClass("visible_error_msg");
        $('#photo_ext_error_message').addClass("invisible_error_msg");
        $('#photo_size_error_message').removeClass("invisible_error_msg");
        $('#photo_size_error_message').addClass("visible_error_msg");
        is_file_valid = false;
      }
    }
    }
    return is_file_valid;
  }